{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Neo/Desktop/WWW/react/skynet/skynet/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Neo/Desktop/WWW/react/skynet/skynet/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Neo/Desktop/WWW/react/skynet/skynet/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import jwtDecode from'jwt-decode';import logo from'../MainWindow/img/logo.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var URL='http://localhost:3001';function Logowanie(_ref){var handleLogin=_ref.handleLogin;var _useState=useState(\"ADMIN11\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"admino\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),token=_useState6[0],setToken=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),serverMessage=_useState8[0],setServerMessage=_useState8[1];useEffect(function(){setToken(generateToken());},[]);var generateToken=function generateToken(){return'_'+Math.random().toString(36).substr(2,9);};var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var response,data,decodedToken;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();console.log('Zanciśnięto przycisk Logowania');// OPERACJA DLA GITHUB PAGES\n// if(username == \"ADMIN11\" && password ==\"admino\"){\n//   handleLogin(\"Logowanie poprawne\");\n//   return;\n// }else{\n//   setServerMessage(`${username} nie ma w bazie`);\n//   return;\n// }\n_context.prev=2;_context.next=5;return fetch(\"\".concat(URL,\"/logowanie\"),{method:'post',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:username,password:password,token:token})});case 5:response=_context.sent;_context.next=8;return response.json();case 8:data=_context.sent;if(data.token){setServerMessage(data.message);localStorage.setItem('token',data.token);decodedToken=jwtDecode(data.token);localStorage.setItem('user',decodedToken.user);localStorage.setItem('role',decodedToken.role);handleLogin(data.message);console.log(\"U\\u017Cytkownik: \".concat(decodedToken.user,\", Token: \").concat(data.token,\", Rola: \").concat(decodedToken.role));}_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](2);setServerMessage(\"Niepoprawne dane logowania: \".concat(_context.t0.message));case 15:case\"end\":return _context.stop();}},_callee,null,[[2,12]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();// Rest of your component...\nreturn/*#__PURE__*/_jsxs(\"div\",{id:\"LOGOWANIE\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"alert\",children:serverMessage&&/*#__PURE__*/_jsx(\"div\",{children:serverMessage})}),/*#__PURE__*/_jsxs(\"div\",{className:\"LG\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logos\",children:/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"\",className:\"logos-SWG\"})}),/*#__PURE__*/_jsx(\"div\",{id:\"logowanie-s\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",id:\"token\",autoComplete:\"off\",name:\"token\",placeholder:\"Token\",value:token,className:\"w100\"}),/*#__PURE__*/_jsxs(\"div\",{id:\"name\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"material-icons prefix cwhite\",children:\"apps\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"first\",autoComplete:\"off\",autoFocus:\"On\",name:\"user\",placeholder:\"Login\",value:username,onChange:function onChange(e){return setUsername(e.target.value);},className:\"w100\"// required\n})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"pass\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"material-icons prefix cwhite\",children:\"lock\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"second\",autoComplete:\"off\",name:\"pass\",placeholder:\"Has\\u0142o\",value:password,onChange:function onChange(e){return setPassword(e.target.value);},className:\"w100\"// required\n})]}),/*#__PURE__*/_jsx(\"div\",{id:\"btn-log-in\",children:/*#__PURE__*/_jsx(\"div\",{className:\"wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"box\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"log-in\",id:\"sub\",children:\"Sign In\"})})})})]})})]})]});}export default Logowanie;","map":{"version":3,"names":["React","useState","useEffect","jwtDecode","logo","jsx","_jsx","jsxs","_jsxs","URL","Logowanie","_ref","handleLogin","_useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","password","setPassword","_useState5","_useState6","token","setToken","_useState7","_useState8","serverMessage","setServerMessage","generateToken","Math","random","toString","substr","handleSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","response","data","decodedToken","wrap","_callee$","_context","prev","next","preventDefault","console","log","fetch","concat","method","headers","body","JSON","stringify","sent","json","message","localStorage","setItem","user","role","t0","stop","_x","apply","arguments","id","children","className","src","alt","onSubmit","type","autoComplete","name","placeholder","value","autoFocus","onChange","e","target"],"sources":["C:/Users/Neo/Desktop/WWW/react/skynet/skynet/src/logowanie/logowanie.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport jwtDecode from 'jwt-decode';\r\nimport logo from '../MainWindow/img/logo.png';\r\n\r\nconst URL = 'http://localhost:3001';\r\n\r\nfunction Logowanie({ handleLogin }) {\r\n  const [username, setUsername] = useState(\"ADMIN11\");\r\n  const [password, setPassword] = useState(\"admino\");\r\n  const [token, setToken] = useState(\"\");\r\n  const [serverMessage, setServerMessage] = useState(\"\");\r\n  \r\n\r\n  useEffect(() => {\r\n    setToken(generateToken());\r\n  }, []);\r\n\r\n  const generateToken = () => {\r\n    return '_' + Math.random().toString(36).substr(2, 9);\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    console.log('Zanciśnięto przycisk Logowania');\r\n\r\n    // OPERACJA DLA GITHUB PAGES\r\n    // if(username == \"ADMIN11\" && password ==\"admino\"){\r\n    //   handleLogin(\"Logowanie poprawne\");\r\n    //   return;\r\n    // }else{\r\n    //   setServerMessage(`${username} nie ma w bazie`);\r\n    //   return;\r\n    // }\r\n\r\n    try {\r\n      const response = await fetch(`${URL}/logowanie`, {\r\n        method: 'post',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ username, password, token })\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.token) {\r\n        setServerMessage(data.message);\r\n        localStorage.setItem('token', data.token);\r\n        const decodedToken = jwtDecode(data.token);\r\n        localStorage.setItem('user', decodedToken.user);\r\n        localStorage.setItem('role', decodedToken.role);\r\n        handleLogin(data.message);\r\n        console.log(`Użytkownik: ${decodedToken.user}, Token: ${data.token}, Rola: ${decodedToken.role}`);\r\n      }\r\n    } catch (error) {\r\n      setServerMessage(`Niepoprawne dane logowania: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  // Rest of your component...\r\n\r\n  return (\r\n    <div id=\"LOGOWANIE\">\r\n      <div className=\"alert\">{serverMessage && <div>{serverMessage}</div>}</div>\r\n      <div className=\"LG\">\r\n        <div className=\"logos\">\r\n          <img src={logo} alt=\"\" className=\"logos-SWG\" />\r\n        </div>\r\n\r\n        <div id=\"logowanie-s\">\r\n          <form onSubmit={handleSubmit}>\r\n          <input\r\n                type=\"hidden\"\r\n                id=\"token\"\r\n                autoComplete=\"off\"\r\n                name=\"token\"\r\n                placeholder=\"Token\"\r\n                value={token}\r\n                className=\"w100\"\r\n              />\r\n\r\n            <div id=\"name\">\r\n              <i className=\"material-icons prefix cwhite\">apps</i>\r\n              <input\r\n                type=\"text\"\r\n                id=\"first\"\r\n                autoComplete=\"off\"\r\n                autoFocus=\"On\"\r\n                name=\"user\"\r\n                placeholder=\"Login\"\r\n                value={username}\r\n                onChange={(e) => setUsername(e.target.value)}\r\n                className=\"w100\"\r\n                // required\r\n              />\r\n            </div>\r\n\r\n            <div id=\"pass\">\r\n              <i className=\"material-icons prefix cwhite\">lock</i>\r\n              <input\r\n                type=\"password\"\r\n                id=\"second\"\r\n                autoComplete=\"off\"\r\n                name=\"pass\"\r\n                placeholder=\"Hasło\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                className=\"w100\"\r\n                // required\r\n              />\r\n            </div>\r\n\r\n            <div id=\"btn-log-in\">\r\n              <div className=\"wrapper\">\r\n                <div className=\"box\">\r\n                  <button type=\"submit\" className=\"log-in\" id=\"sub\">\r\n                    Sign In\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Logowanie;\r\n\r\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}